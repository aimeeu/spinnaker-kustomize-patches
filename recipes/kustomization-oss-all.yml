#-------------------------------------------------------------------------------
# Minimum Starting Point Recipe with Armory Scale Agent.
#
# Self contained Spinnaker installation with no external dependencies and no
# additional configuration needed. This is intended as a starting point for any
# kubernetes cluster. Not for production use.
#
# Features:
# - Spinnaker Operator
# - One Kubernetes account (Spinnaker's own cluster) using the Scale Agent
# - Spinnaker authentication disabled
# - Self hosted minio as a persistent storage
# - Self hosted redis backend for caching and temporal storage of services
#
# Scratch:
#   - [x] Kustomization -- example e2e install
#   - [ ] Operator config
#   - [x] OSS transformer
#   - [ ] Component -- just installs scale agent
#   - [ ] SA & Bindings
#-------------------------------------------------------------------------------
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: spinnaker

components:
  - core/base
  - core/persistence/in-cluster
  - targets/kubernetes/scale-agent/plugin
  #- targets/kubernetes/default

patchesStrategicMerge:
  - core/patches/oss-version.yml

transformers:
  - utilities/unique-service-account.yml

patches:
  - target:
      kind: SpinnakerService
    path: utilities/switch-to-oss.yml
